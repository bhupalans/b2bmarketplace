rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {

    // --- TEMPORARY SEEDING RULES ---
    // These rules are intentionally relaxed to allow the initial database seed to run from the client.
    // After successfully seeding the database, these should be replaced with more secure rules.

    // Allow public read on categories and products.
    // Allow any authenticated user to write/create for the seeding process.
    match /categories/{categoryId} {
      allow read: if true;
      allow write: if request.auth != null;
    }

    match /products/{productId} {
      allow read: if true;
      allow write: if request.auth != null;
    }

    // Allow public read on user profiles.
    // Allow any authenticated user to create user documents for the seeding process.
    match /users/{userId} {
      allow read: if true;
      allow write: if request.auth != null;
    }

    // Allow the seeder to write the status document.
    match /internal/{docId} {
        allow read, write: if request.auth != null;
    }

    // Default deny all other collections.
    match /{document=**} {
      allow read, write: if false;
    }
  }
}
